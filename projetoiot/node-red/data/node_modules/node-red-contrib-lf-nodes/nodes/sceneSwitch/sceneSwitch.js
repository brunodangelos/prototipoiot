module.exports = function(RED) {
  function sceneSwitch(config) {
    RED.nodes.createNode(this, config);
    var context = this.context();
    this.sceneName = config.sceneName;
    this.buttonID = config.buttonID;
    this.passButtonID = config.passButtonID;
    var node = this;
    this.on("input", function(msg) {
      var data = JSON.parse(msg.payload);
      if (Object.keys(data)[0] && Object.keys(data)[0] == node.buttonID) {
        msg.payload = { sceneSwitch: node.sceneName };
        if (node.passButtonID) {
          msg.payload = {
            ...msg.payload,
            sceneFromButtonId: node.buttonID
          };
        }
        node.send(msg);
      }
    });
  }
  RED.nodes.registerType("sceneSwitch", sceneSwitch);
};
